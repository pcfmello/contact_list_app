$(document).ready(function(){var a=function(){var a="contatoAppList",t=function(){return JSON.parse(localStorage.getItem(a))},o=function(t){localStorage.setItem(a,JSON.stringify(t))};return{getLocalStorage:t,setLocalStorage:o}}(),t=function(){var t=function(){$("#nome").val(""),$("#telefone").val(""),$("#email").val(""),$("#assunto").val("")},o=function(t,o,n){var e={paginas_attributes:[]};e.paginas_attributes.push({nome:t,url:o,data_acesso:n}),a.setLocalStorage(e)},n=function(t,o,n){var e=a.getLocalStorage(),i=-1;e.paginas_attributes.forEach(function(a){a.nome===t&&(i=e.paginas_attributes.indexOf(a))}),i>=0?e.paginas_attributes.splice(i,1,{nome:t,url:o,data_acesso:n}):e.paginas_attributes.push({nome:t,url:o,data_acesso:n}),a.setLocalStorage(e)},e=function(){var o={nome:$("#nome").val(),telefone:$("#telefone").val(),email:$("#email").val(),assunto:$("#assunto").val()};$.ajax({url:window.location.origin.concat("/contatos.json"),type:"POST",data:{contato:o},datatype:"json",success:function(o){a.getLocalStorage().paginas_attributes.forEach(function(a){a.contato_id=o.id,$.ajax({url:window.location.origin.concat("/pagina_update.json"),type:"POST",data:{pagina:a},datatype:"json",success:function(a){$("#modal-cadastro-ok").modal("show"),t()},error:function(a,t){$("#modal-cadastro-erro").modal("show")}})});var n=a.getLocalStorage();n.email=o.email,a.setLocalStorage(n)}})},i=function(t){var o=a.getLocalStorage().paginas_attributes,n={};o.forEach(function(a){a.nome===$("#pageTitle").html()&&(a.contato_id=t,n=a)}),$.ajax({url:window.location.origin.concat("/pagina_update.json"),type:"POST",data:{pagina:n},datatype:"json",success:function(a){}})},c=function(){var t={email:a.getLocalStorage().email};$.ajax({url:window.location.origin.concat("/get_contato_by_email.json"),type:"POST",data:{contato:t},datatype:"json",success:function(a){i(a)}})};return{insert:o,update:n,sendForm:e,getContatoByEmail:c}}(),o=function(){var o=a.getLocalStorage();if(o){t.update($("#pageTitle").html(),$(location).attr("href"),new Date)}else t.insert($("#pageTitle").html(),$(location).attr("href"),new Date);a.getLocalStorage().email&&t.getContatoByEmail()};$("#btEnviar").click(function(){t.sendForm()}),o()});